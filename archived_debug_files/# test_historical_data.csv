# test_historical_data.csv

import pandas as pd
import os

def test_historical_data_columns():
    df = pd.read_csv("historical_data.csv")
    expected_cols = [
        "Datetime", "Ticker", "Open", "High", "Low", "Close", "Volume", "averageVolume10day"
    ]
    assert list(df.columns) == expected_cols

def test_historical_data_no_missing_required():
    df = pd.read_csv("historical_data.csv")
    required_cols = ["Datetime", "Ticker", "Open", "High", "Low", "Close", "Volume"]
    assert df[required_cols].isnull().sum().sum() == 0

def test_historical_data_price_positive():
    df = pd.read_csv("historical_data.csv")
    for col in ["Open", "High", "Low", "Close"]:
        assert (df[col] > 0).all()

def test_historical_data_volume_non_negative():
    df = pd.read_csv("historical_data.csv")
    assert (df["Volume"] >= 0).all()

def test_historical_data_tickers_in_etf_list():
    df = pd.read_csv("historical_data.csv")
    leveraged_etfs = [
        'TQQQ', 'TECL', 'BITX', 'MSTX', 'BITU', 'USD', 'ETHU', 'ROM', 'NVDU', 'AGQ',
        'LABU', 'GDXU', 'NUGT', 'SMCX', 'CWEB', 'JNUG', 'NAIL', 'DFEN', 'ERX', 'SDOW',
        'TMV', 'BOIL', 'MSFU', 'MVV'
    ]
    assert set(df["Ticker"].unique()).issubset(set(leveraged_etfs))